(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-00756354"],{"1dde":function(e,t,n){var s=n("d039"),o=n("b622"),i=n("2d00"),a=o("species");e.exports=function(e){return i>=51||!s((function(){var t=[],n=t.constructor={};return n[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"65f0":function(e,t,n){var s=n("861d"),o=n("e8b5"),i=n("b622"),a=i("species");e.exports=function(e,t){var n;return o(e)&&(n=e.constructor,"function"!=typeof n||n!==Array&&!o(n.prototype)?s(n)&&(n=n[a],null===n&&(n=void 0)):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},8418:function(e,t,n){"use strict";var s=n("c04e"),o=n("9bf2"),i=n("5c6c");e.exports=function(e,t,n){var a=s(t);a in e?o.f(e,a,i(0,n)):e[a]=n}},"99af":function(e,t,n){"use strict";var s=n("23e7"),o=n("d039"),i=n("e8b5"),a=n("861d"),r=n("7b0b"),c=n("50c4"),u=n("8418"),l=n("65f0"),m=n("1dde"),d=n("b622"),h=n("2d00"),f=d("isConcatSpreadable"),b=9007199254740991,p="Maximum allowed index exceeded",g=h>=51||!o((function(){var e=[];return e[f]=!1,e.concat()[0]!==e})),v=m("concat"),w=function(e){if(!a(e))return!1;var t=e[f];return void 0!==t?!!t:i(e)},k=!g||!v;s({target:"Array",proto:!0,forced:k},{concat:function(e){var t,n,s,o,i,a=r(this),m=l(a,0),d=0;for(t=-1,s=arguments.length;t<s;t++)if(i=-1===t?a:arguments[t],w(i)){if(o=c(i.length),d+o>b)throw TypeError(p);for(n=0;n<o;n++,d++)n in i&&u(m,d,i[n])}else{if(d>=b)throw TypeError(p);u(m,d++,i)}return m.length=d,m}})},b0c0:function(e,t,n){var s=n("83ab"),o=n("9bf2").f,i=Function.prototype,a=i.toString,r=/^\s*function ([^ (]*)/,c="name";s&&!(c in i)&&o(i,c,{configurable:!0,get:function(){try{return a.call(this).match(r)[1]}catch(e){return""}}})},bb51:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("chatRoom")],1)},o=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"chartroom"}},[n("div",[n("div",{staticStyle:{float:"left"}},[e._v(e._s(e.name)+" 你好!")]),n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-prevent-closing",modifiers:{"modal-prevent-closing":!0}}],staticStyle:{float:"right"}},[e._v("修改昵称")]),n("b-modal",{ref:"modal",attrs:{id:"modal-prevent-closing",title:"Submit Your Name"},on:{show:e.resetModal,hidden:e.resetModal,ok:e.handleOk},model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}},[n("form",{ref:"form",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit(t)}}},[n("b-form-group",{attrs:{state:e.nameState,label:"Name","label-for":"name-input","invalid-feedback":"Name is required"}},[n("b-form-input",{attrs:{id:"name-input",state:e.nameState,required:""},model:{value:e.inputname,callback:function(t){e.inputname=t},expression:"inputname"}})],1)],1)])],1),n("b-container",{staticClass:"bv-example-row",style:{height:e.height-90+"px"},attrs:{id:"messages"}},e._l(e.msglist,(function(t){return n("div",{key:t.id,class:t.user},[n("span",[e._v(" "+e._s(t.msg)+" ")])])})),0),n("b-input-group",{staticClass:"mt-3"},[n("b-form-input",{model:{value:e.sendmessage,callback:function(t){e.sendmessage=t},expression:"sendmessage"}}),n("b-button",{attrs:{variant:"success"},on:{click:e.sendmsg}},[e._v("发送")]),n("b-button",{attrs:{variant:"secondary"},on:{click:e.clearmsg}},[e._v("清空")])],1)],1)},a=[],r=(n("99af"),n("b0c0"),{name:"ChatRoom",data:function(){return{wsuri:"ws://127.0.0.1:3000",name:"",inputname:"",nameState:null,modalShow:!0,sendmessage:"",msglist:[],height:document.documentElement.clientHeight}},created:function(){this.initWebSocket()},destroyed:function(){this.websock.close()},mounted:function(){var e=this;window.onresize=function(){e.height=document.documentElement.clientHeight}},watch:{},methods:{initWebSocket:function(){console.log(this.wsuri),this.websock=new WebSocket(this.wsuri),this.websock.onmessage=this.websocketonmessage,this.websock.onopen=this.websocketonopen,this.websock.onerror=this.websocketonerror,this.websock.onclose=this.websocketclose},websocketonopen:function(){console.log("WS已連線"),this.msglist.push({user:"system",msg:"聊天室已連接"})},websocketonerror:function(){},websocketonmessage:function(e){var t=JSON.parse(e.data);switch(t.user){case"other":this.msglist.push({user:t.user,msg:"".concat(t.sender," : ").concat(t.msg)});break;case"system":this.msglist.push({user:t.user,msg:t.msg});break;default:break}console.log(this.msglist),console.log(t)},websocketsend:function(e){this.websock.send(e)},websocketclose:function(e){console.log(e)},sendmsg:function(){this.sendmessage&&(this.websocketsend(JSON.stringify({type:"1",msg:this.sendmessage})),this.msglist.push({user:"me",msg:this.sendmessage}),this.sendmessage="")},clearmsg:function(){this.msglist=[]},checkFormValidity:function(){var e=this.$refs.form.checkValidity();return this.nameState=e,e},resetModal:function(){this.nameState=null,this.inputname=this.name},handleOk:function(e){e.preventDefault(),this.handleSubmit()},handleSubmit:function(){var e=this;this.checkFormValidity()&&(this.$nextTick((function(){e.$bvModal.hide("modal-prevent-closing")})),this.name?this.websocketsend(JSON.stringify({type:"2",name:this.inputname})):(console.log("set"),this.websocketsend(JSON.stringify({type:"0",name:this.inputname}))),this.name=this.inputname,this.nameState=null)}}}),c=r,u=(n("de16"),n("2877")),l=Object(u["a"])(c,i,a,!1,null,"7e0fbde2",null),m=l.exports,d={name:"Home",components:{chatRoom:m}},h=d,f=Object(u["a"])(h,s,o,!1,null,null,null);t["default"]=f.exports},bd89:function(e,t,n){},de16:function(e,t,n){"use strict";var s=n("bd89"),o=n.n(s);o.a},e8b5:function(e,t,n){var s=n("c6b6");e.exports=Array.isArray||function(e){return"Array"==s(e)}}}]);